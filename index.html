<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è‹±è¯­å‘éŸ³ç»ƒä¹ </title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --cream: #faf6ef;
    --ink: #1a1410;
    --warm: #c8956c;
    --warm-light: #f0e0d0;
    --us-color: #2d5a8e;
    --uk-color: #8e2d2d;
    --shadow: 0 4px 24px rgba(26,20,16,0.10);
  }

  body {
    background: var(--cream);
    font-family: 'DM Sans', sans-serif;
    color: var(--ink);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }

  .card {
    background: #fff;
    border-radius: 20px;
    box-shadow: var(--shadow);
    padding: 36px 32px 28px;
    width: 100%;
    max-width: 480px;
    border: 1px solid rgba(200,149,108,0.15);
  }

  .header {
    text-align: center;
    margin-bottom: 28px;
  }

  .header h1 {
    font-family: 'Playfair Display', serif;
    font-size: 1.6rem;
    color: var(--ink);
    letter-spacing: 0.02em;
  }

  .header p {
    font-size: 0.82rem;
    color: #888;
    margin-top: 4px;
    font-weight: 300;
  }

  .divider {
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--warm-light), transparent);
    margin: 0 auto 28px;
    width: 60%;
  }

  .input-area {
    position: relative;
    margin-bottom: 22px;
  }

  textarea {
    width: 100%;
    padding: 16px 18px;
    border: 1.5px solid #e8ddd4;
    border-radius: 12px;
    font-family: 'DM Sans', sans-serif;
    font-size: 1.05rem;
    color: var(--ink);
    background: var(--cream);
    resize: none;
    outline: none;
    transition: border-color 0.2s;
    min-height: 90px;
    line-height: 1.6;
  }

  textarea:focus {
    border-color: var(--warm);
    background: #fff;
  }

  textarea::placeholder { color: #bbb; font-weight: 300; }

  .clear-btn {
    position: absolute;
    top: 10px; right: 12px;
    background: none;
    border: none;
    cursor: pointer;
    color: #ccc;
    font-size: 1.1rem;
    transition: color 0.2s;
    line-height: 1;
  }
  .clear-btn:hover { color: var(--warm); }

  /* Speed Control */
  .speed-section {
    margin-bottom: 22px;
    background: var(--cream);
    border-radius: 12px;
    padding: 14px 16px;
  }

  .speed-label-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }

  .speed-label {
    font-size: 0.8rem;
    font-weight: 500;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  .speed-badge {
    background: var(--warm);
    color: #fff;
    font-size: 0.78rem;
    font-weight: 500;
    padding: 2px 10px;
    border-radius: 20px;
    min-width: 52px;
    text-align: center;
  }

  .speed-presets {
    display: flex;
    gap: 6px;
    margin-bottom: 10px;
  }

  .preset-btn {
    flex: 1;
    padding: 5px 0;
    border: 1.5px solid #e8ddd4;
    border-radius: 8px;
    background: #fff;
    cursor: pointer;
    font-size: 0.78rem;
    font-family: 'DM Sans', sans-serif;
    color: #888;
    transition: all 0.15s;
    font-weight: 400;
  }

  .preset-btn:hover, .preset-btn.active {
    border-color: var(--warm);
    color: var(--warm);
    background: var(--warm-light);
  }

  input[type=range] {
    width: 100%;
    -webkit-appearance: none;
    height: 4px;
    border-radius: 4px;
    background: linear-gradient(90deg, var(--warm) 0%, #e8ddd4 0%);
    outline: none;
    cursor: pointer;
  }

  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 18px; height: 18px;
    border-radius: 50%;
    background: var(--warm);
    box-shadow: 0 2px 8px rgba(200,149,108,0.35);
    transition: transform 0.15s;
  }

  input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.2); }

  /* Play Buttons */
  .buttons-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 16px;
  }

  .play-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 16px 12px;
    border-radius: 14px;
    border: none;
    cursor: pointer;
    font-family: 'DM Sans', sans-serif;
    transition: all 0.18s;
    position: relative;
    overflow: hidden;
  }

  .play-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity 0.18s;
  }

  .play-btn:active { transform: scale(0.97); }

  .btn-us {
    background: linear-gradient(135deg, #2d5a8e, #1e3f66);
    color: #fff;
    box-shadow: 0 4px 16px rgba(45,90,142,0.25);
  }

  .btn-us:hover { box-shadow: 0 6px 24px rgba(45,90,142,0.4); transform: translateY(-1px); }

  .btn-uk {
    background: linear-gradient(135deg, #8e2d2d, #6b2020);
    color: #fff;
    box-shadow: 0 4px 16px rgba(142,45,45,0.25);
  }

  .btn-uk:hover { box-shadow: 0 6px 24px rgba(142,45,45,0.4); transform: translateY(-1px); }

  .btn-flag { font-size: 1.6rem; line-height: 1; }

  .btn-label {
    font-size: 0.85rem;
    font-weight: 500;
    letter-spacing: 0.04em;
  }

  .btn-sub {
    font-size: 0.7rem;
    opacity: 0.75;
    font-weight: 300;
  }

  .play-btn.playing {
    animation: pulse 0.8s infinite alternate;
  }

  @keyframes pulse {
    from { filter: brightness(1); }
    to { filter: brightness(1.15); }
  }

  /* Stop button */
  .stop-btn {
    width: 100%;
    padding: 10px;
    border: 1.5px solid #e8ddd4;
    border-radius: 10px;
    background: #fff;
    color: #aaa;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.82rem;
    cursor: pointer;
    transition: all 0.15s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
  }

  .stop-btn:hover { border-color: #ccc; color: #666; }

  /* Status */
  .status {
    text-align: center;
    font-size: 0.78rem;
    color: #aaa;
    margin-top: 14px;
    min-height: 18px;
    font-weight: 300;
  }

  .status.speaking { color: var(--warm); }
  .status.error { color: #e05050; }

  /* Footer */
  .footer {
    text-align: center;
    margin-top: 20px;
    font-size: 0.7rem;
    color: #ccc;
  }

  .no-support {
    background: #fff3cd;
    border: 1px solid #ffc107;
    border-radius: 10px;
    padding: 14px;
    margin-top: 16px;
    font-size: 0.82rem;
    color: #856404;
    text-align: center;
    display: none;
  }
</style>
</head>
<body>

<div class="card">
  <div class="header">
    <h1>ğŸ—£ è‹±è¯­å‘éŸ³ç»ƒä¹ </h1>
    <p>è¾“å…¥å•è¯æˆ–å¥å­ï¼Œé€‰æ‹©ç¾å¼æˆ–è‹±å¼æœ—è¯»</p>
  </div>
  <div class="divider"></div>

  <div class="input-area">
    <textarea id="textInput" placeholder="åœ¨è¿™é‡Œè¾“å…¥è‹±æ–‡å•è¯æˆ–å¥å­&#10;ä¾‹å¦‚ï¼šHello, how are you?" rows="3"></textarea>
    <button class="clear-btn" onclick="clearText()" title="æ¸…ç©º">âœ•</button>
  </div>

  <div class="speed-section">
    <div class="speed-label-row">
      <span class="speed-label">ğŸ¢ è¯­é€Ÿè°ƒèŠ‚</span>
      <span class="speed-badge" id="speedDisplay">æ­£å¸¸</span>
    </div>
    <div class="speed-presets">
      <button class="preset-btn" onclick="setSpeed(0.5)">å¾ˆæ…¢</button>
      <button class="preset-btn active" onclick="setSpeed(0.8)">æ…¢é€Ÿ</button>
      <button class="preset-btn" onclick="setSpeed(1.0)">æ­£å¸¸</button>
      <button class="preset-btn" onclick="setSpeed(1.3)">å¿«é€Ÿ</button>
    </div>
    <input type="range" id="speedSlider" min="0.3" max="1.8" step="0.05" value="0.8" oninput="updateSpeed(this.value)">
  </div>

  <div class="buttons-row">
    <button class="play-btn btn-us" onclick="speak('us')" id="btnUS">
      <span class="btn-flag">ğŸ‡ºğŸ‡¸</span>
      <span class="btn-label">ç¾å¼å‘éŸ³</span>
      <span class="btn-sub">American English</span>
    </button>
    <button class="play-btn btn-uk" onclick="speak('uk')" id="btnUK">
      <span class="btn-flag">ğŸ‡¬ğŸ‡§</span>
      <span class="btn-label">è‹±å¼å‘éŸ³</span>
      <span class="btn-sub">British English</span>
    </button>
  </div>

  <button class="stop-btn" onclick="stopSpeaking()">â¹ åœæ­¢æ’­æ”¾</button>

  <div class="status" id="status">å‡†å¤‡å°±ç»ªï¼Œè¯·è¾“å…¥å†…å®¹åç‚¹å‡»æ’­æ”¾</div>

  <div class="no-support" id="noSupport">
    âš ï¸ ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ Chrome æˆ– Edge æµè§ˆå™¨æ‰“å¼€æ­¤é¡µé¢ã€‚
  </div>

  <div class="footer">ç”±æµè§ˆå™¨è¯­éŸ³å¼•æ“é©±åŠ¨ Â· æ— éœ€ç½‘ç»œ</div>
</div>

<script>
let currentSpeed = 0.8;
let currentUtterance = null;

// Check support
if (!('speechSynthesis' in window)) {
  document.getElementById('noSupport').style.display = 'block';
}

function setStatus(msg, cls) {
  const el = document.getElementById('status');
  el.textContent = msg;
  el.className = 'status ' + (cls || '');
}

function clearText() {
  document.getElementById('textInput').value = '';
  document.getElementById('textInput').focus();
}

function setSpeed(val) {
  currentSpeed = val;
  document.getElementById('speedSlider').value = val;
  updateSpeedDisplay(val);
  document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
  updateSliderFill(val);
}

function updateSpeed(val) {
  currentSpeed = parseFloat(val);
  updateSpeedDisplay(currentSpeed);
  document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
  updateSliderFill(val);
}

function updateSliderFill(val) {
  const slider = document.getElementById('speedSlider');
  const min = parseFloat(slider.min), max = parseFloat(slider.max);
  const pct = ((val - min) / (max - min)) * 100;
  slider.style.background = `linear-gradient(90deg, #c8956c ${pct}%, #e8ddd4 ${pct}%)`;
}

function updateSpeedDisplay(val) {
  const map = [[0.4, 'ææ…¢'], [0.65, 'å¾ˆæ…¢'], [0.85, 'æ…¢é€Ÿ'], [1.05, 'æ­£å¸¸'], [1.35, 'å¿«é€Ÿ'], [1.8, 'æå¿«']];
  let label = 'æå¿«';
  for (const [threshold, name] of map) {
    if (val <= threshold) { label = name; break; }
  }
  document.getElementById('speedDisplay').textContent = label;
}

// Initialize slider fill
updateSliderFill(0.8);

function getVoice(accent) {
  const voices = speechSynthesis.getVoices();
  
  if (accent === 'us') {
    // Try to find US English voice
    const priority = [
      v => v.name.includes('Samantha'),
      v => v.name.includes('Alex'),
      v => v.name.includes('Karen'),
      v => v.lang === 'en-US' && v.localService,
      v => v.lang === 'en-US',
      v => v.lang.startsWith('en'),
    ];
    for (const test of priority) {
      const found = voices.find(test);
      if (found) return found;
    }
  } else {
    // Try to find UK English voice
    const priority = [
      v => v.name.includes('Daniel') && v.lang === 'en-GB',
      v => v.name.includes('Kate'),
      v => v.name.includes('Serena'),
      v => v.name.includes('Oliver'),
      v => v.lang === 'en-GB' && v.localService,
      v => v.lang === 'en-GB',
      v => v.name.toLowerCase().includes('british'),
    ];
    for (const test of priority) {
      const found = voices.find(test);
      if (found) return found;
    }
  }
  return null;
}

function speak(accent) {
  const text = document.getElementById('textInput').value.trim();
  if (!text) {
    setStatus('è¯·å…ˆè¾“å…¥è¦æœ—è¯»çš„å†…å®¹ âœï¸', 'error');
    return;
  }

  stopSpeaking();

  // Wait for voices to load
  const trySpeak = () => {
    const voice = getVoice(accent);
    const utter = new SpeechSynthesisUtterance(text);
    utter.rate = currentSpeed;
    utter.pitch = 1;
    utter.volume = 1;
    
    if (voice) {
      utter.voice = voice;
      utter.lang = voice.lang;
    } else {
      utter.lang = accent === 'us' ? 'en-US' : 'en-GB';
    }

    const flag = accent === 'us' ? 'ğŸ‡ºğŸ‡¸' : 'ğŸ‡¬ğŸ‡§';
    const label = accent === 'us' ? 'ç¾å¼å‘éŸ³' : 'è‹±å¼å‘éŸ³';
    const voiceName = voice ? voice.name : 'é»˜è®¤';

    utter.onstart = () => {
      setStatus(`${flag} æ­£åœ¨æ’­æ”¾${label}ï¼ˆ${voiceName}ï¼‰...`, 'speaking');
      document.getElementById('btn' + accent.toUpperCase()).classList.add('playing');
    };

    utter.onend = () => {
      setStatus('æ’­æ”¾å®Œæ¯• âœ“');
      document.getElementById('btn' + accent.toUpperCase()).classList.remove('playing');
    };

    utter.onerror = (e) => {
      if (e.error !== 'interrupted') {
        setStatus('æ’­æ”¾å‡ºé”™ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨æƒé™', 'error');
      }
      document.getElementById('btn' + accent.toUpperCase()).classList.remove('playing');
    };

    currentUtterance = utter;
    speechSynthesis.speak(utter);
  };

  if (speechSynthesis.getVoices().length === 0) {
    speechSynthesis.onvoiceschanged = trySpeak;
  } else {
    trySpeak();
  }
}

function stopSpeaking() {
  speechSynthesis.cancel();
  document.querySelectorAll('.play-btn').forEach(b => b.classList.remove('playing'));
  setStatus('å·²åœæ­¢');
}

// Keyboard shortcut: Enter to play US, Shift+Enter for UK
document.getElementById('textInput').addEventListener('keydown', function(e) {
  if (e.key === 'Enter' && !e.shiftKey && !e.ctrlKey) {
    e.preventDefault();
    speak('us');
  }
});
</script>
</body>
</html>
